(function(q,N){var C,v,D;function k(){return L+M++}function H(){A||(A=w.find("a[commandName]"));A.each(function(){var b=a(this),d=a.trim(b.attr("commandName")).toLowerCase();"insertunorderedlist"!==d&&"insertorderedlist"!==d&&(m.queryCommandState(d)?b.addClass("btn-selected"):b.removeClass("btn-selected"))})}function E(){var b=r.length,a=f.html();0<b&&a===r[b-1]||(r.push(a),20<=b&&r.shift(),b=r.length,n=b-1)}function I(a){return a.parent().is('div[contenteditable="true"]')?a:"body"===a[0].nodeName.toLowerCase()?
f.children().last():a.is('div[contenteditable="true"]')?a.children().last():I(a.parent())}function u(a,d,c,l){if(g){var e;if(g){var h;J?(h=m.getSelection(),h.removeAllRanges(),h.addRange(g)):(h=m.selection.createRange(),h.setEndPoint("EndToEnd",g),0===g.text.length?h.collapse(!1):h.setEndPoint("StartToStart",g),h.select())}try{e=m.queryCommandEnabled(d)}catch(x){e=!1}!0===e?m.execCommand(d,!1,c):(e=K[d])&&e(d,c);l&&l.call(f);H();F.find(".modal").hide();B.hide();E()}a.preventDefault()}if(q.jQuery){var m=
q.document,a=q.jQuery,J="function"===typeof m.createRange,g,p,y,G,f=a('<div contenteditable="true" class="textarea" ></div>'),w=a('<div class="btn-container"></div>'),B=a('<div class="mask"></div>'),F=a("<div></div>"),A,K,r=[],n=0,L="wangeditor_"+Math.random().toString().replace(".","")+"_",M=1;q.wangEditor_getUniqeId||(q.wangEditor_getUniqeId=k);C="\u5b8b\u4f53;\u9ed1\u4f53;\u6977\u4f53;\u96b6\u4e66;\u5e7c\u5706;\u5fae\u8f6f\u96c5\u9ed1;Arial;Verdana;Georgia;Times New Roman;Trebuchet MS;Courier New;Impact;Comic Sans MS".split(";");
v={"#880000":"\u6697\u7ea2\u8272","#800080":"\u7d2b\u8272","#ff0000":"\u7ea2\u8272","#ff00ff":"\u9c9c\u7c89\u8272","#000080":"\u6df1\u84dd\u8272","#0000ff":"\u84dd\u8272","#00ffff":"\u6e56\u84dd\u8272","#008080":"\u84dd\u7eff\u8272","#008000":"\u7eff\u8272","#808000":"\u6a44\u6984\u8272","#00ff00":"\u6d45\u7eff\u8272","#ffcc00":"\u6a59\u9ec4\u8272","#808080":"\u7070\u8272","#c0c0c0":"\u94f6\u8272","#000000":"\u9ed1\u8272"};D={1:"10px",2:"13px",3:"16px",4:"19px",5:"22px",6:"25px",7:"28px"};G="fontFamily fontSize | bold underline italic | foreColor backgroundColor removeFormat | unOrderedList orderedList | justifyLeft justifyCenter justifyRight | createLink unLink | insertHr insertTable webImage | undo redo".split(" ");
y={fontFamily:{title:"\u5b57\u4f53",type:"dropMenu",txt:"fa fa-font",command:"fontName ",dropMenu:function(){var b=[];a.each(C,function(a,c){b.push('<li><a href="#" commandValue="${value}" style="font-family:${family};">${txt}</a></li>'.replace("${value}",c).replace("${family}",c).replace("${txt}",c))});return a("<ul>"+b.join("")+"</ul>")}()},fontSize:{title:"\u5b57\u53f7",type:"dropMenu",txt:"fa fa-text-height",command:"fontSize",dropMenu:function(){var b=[];a.each(D,function(a,c){b.push('<li><a href="#" commandValue="${value}" style="font-size:${fontsize};">${txt}</a></li>'.replace("${value}",
a).replace("${fontsize}",c).replace("${txt}",c))});return a("<ul>"+b.join("")+"</ul>")}()},bold:{title:"\u52a0\u7c97",type:"btn",txt:"fa fa-bold",command:"bold",callback:function(){}},underline:{title:"\u4e0b\u5212\u7ebf",type:"btn",txt:"fa fa-underline",command:"underline "},italic:{title:"\u659c\u4f53",type:"btn",txt:"fa fa-italic",command:"italic "},foreColor:{title:"\u524d\u666f\u8272",type:"dropMenu",txt:"fa fa-pencil|color:#4a7db1",command:"foreColor ",dropMenu:function(){var b=[];a.each(v,
function(a,c){b.push('<li><a href="#" commandValue="${value}" style="color:${color};">${txt}</a></li>'.replace("${value}",a).replace("${color}",a).replace("${txt}",c))});return a("<ul>"+b.join("")+"</ul>")}()},backgroundColor:{title:"\u80cc\u666f\u8272",type:"dropMenu",txt:"fa fa-paint-brush|color:Red",command:"backColor ",dropMenu:function(){var b=[];a.each(v,function(a,c){b.push('<li><a href="#" commandValue="${value}" style="background-color:${color};color:#ffffff;">${txt}</a></li>'.replace("${value}",
a).replace("${color}",a).replace("${txt}",c))});return a("<ul>"+b.join("")+"</ul>")}()},removeFormat:{title:"\u6e05\u9664\u683c\u5f0f",type:"btn",txt:"fa fa-eraser",command:"RemoveFormat "},unOrderedList:{title:"\u65e0\u5e8f\u5217\u8868",type:"btn",txt:"fa fa-list-ul",command:"InsertUnorderedList "},orderedList:{title:"\u6709\u5e8f\u5217\u8868",type:"btn",txt:"fa fa-list-ol",command:"InsertOrderedList "},justifyLeft:{title:"\u5de6\u5bf9\u9f50",type:"btn",txt:"fa fa-align-left",command:"JustifyLeft "},
justifyCenter:{title:"\u5c45\u4e2d",type:"btn",txt:"fa fa-align-center",command:"JustifyCenter"},justifyRight:{title:"\u53f3\u5bf9\u9f50",type:"btn",txt:"fa fa-align-right",command:"JustifyRight "},createLink:{title:"\u63d2\u5165\u94fe\u63a5",type:"modal-small",txt:"fa fa-link",modal:function(){var b=k(),d=k(),c=k(),l=k();$modal=a('<div>   \u94fe\u63a5\uff1a<input id="'+b+'" type="text" style="width:300px;"/><br />   \u6807\u9898\uff1a<input id="'+d+'" type="text" style="width:300px;"/><br />   \u65b0\u7a97\u53e3\uff1a<input id="'+
c+'" type="checkbox" checked="checked"/><br />   <button id="'+l+'" type="button" class="btn">\u63d2\u5165\u94fe\u63a5</button></div>');callback=function(){$modal.find("input").val("")};$modal.find("#"+l).click(function(e){var h=a.trim($modal.find("#"+b).val()),x=a.trim($modal.find("#"+d).val()),l=$modal.find("#"+c).is(":checked");h||(h=a.trim(m.getElementById(b).value),x=a.trim(m.getElementById(d).value));""!==h&&(""!==x||l?u(e,"customCreateLink",{url:h,title:x,isBlank:l},callback):u(e,"createLink",
h,callback))});return $modal}()},unLink:{title:"\u53d6\u6d88\u94fe\u63a5",type:"btn",txt:"fa fa-unlink",command:"unLink "},insertHr:{title:"\u63d2\u5165\u6a2a\u7ebf",type:"btn",txt:"fa fa-minus",command:"InsertHorizontalRule "},insertTable:{title:"\u63d2\u5165\u8868\u683c",type:"modal-small",txt:"fa fa-table",modal:function(){var b=k(),d=k(),c=k(),l=k(),e=a('<div>   \u884c\u6570\uff1a<input id="'+b+'" type="text" style="width:30px;"/>   \u5217\u6570\uff1a<input id="'+d+'" type="text"  style="width:30px;"/>   \u663e\u793a\u6807\u9898\u884c\uff1a<input id="'+
c+'" type="checkbox" checked="checked"/>   &nbsp;&nbsp;&nbsp;&nbsp;   <button id="'+l+'" class="btn">\u63d2\u5165\u8868\u683c</button>',"</div>"),h=function(){e.find("input").val("")};e.find("#"+l).click(function(a){var l=e.find("#"+b).val(),l=""===l||isNaN(+l)?3:l,f=e.find("#"+d).val(),f=""===f||isNaN(+f)?5:f,m=e.find("#"+c).is(":checked"),k,p;k="";var n=[],g=[];for(k=0;k<l;k++){g=[];for(p=0;p<f;p++)g.push('<td style="width:100px;">&nbsp;</td>');0===k&&m?n.push('<tr style="font-weight:bold;background-color:#f1f1f1;">${content}</tr>'.replace("${content}",
g.join(""))):n.push("<tr>${content}</tr>".replace("${content}",g.join("")))}k='<table border="1" bordercolor="#cccccc" cellpadding="0" cellspacing="0" style="border-collapse:collapse;" > ${content} </table>'.replace("${content}",n.join(""));u(a,"insertHTML",k,h)});return e}()},webImage:{title:"\u7f51\u7edc\u56fe\u7247",type:"modal-small",txt:"fa fa-image",modal:function(){var b=k(),d=k(),c=k();$modal=a('<div>   \u7f51\u5740\uff1a<input id="'+b+'" type="text" style="width:300px;"/><br/>   \u6807\u9898\uff1a<input id="'+
d+'" type="text" style="width:300px;"/><br/>   <button id="'+c+'" type="button" class="btn">\u63d2\u5165\u56fe\u7247</button></div>');callback=function(){$modal.find("input").val("")};$modal.find("#"+c).click(function(c){var e=a.trim($modal.find("#"+b).val()),h=a.trim($modal.find("#"+d).val());e||(e=a.trim(m.getElementById(b).value),h=a.trim(m.getElementById(h).value));""!==e&&(""===h?u(c,"insertImage",e,callback):u(c,"customeInsertImage",{url:e,title:h},callback))});return $modal}()},undo:{title:"\u64a4\u9500",
type:"btn",txt:"fa fa-undo",command:function(a){0<n&&(n-=1,f.html(r[n]));a.preventDefault()}},redo:{title:"\u91cd\u590d",type:"btn",txt:"fa fa-repeat",command:function(a){n<r.length-1&&(n+=1,f.html(r[n]));a.preventDefault()}}};K={insertHTML:function(b,d){var c;g&&(c=I(a(p)),0===c.next().length&&(d+="<p>&nbsp;</p>"),c.after(a(d)))},customCreateLink:function(b,d){for(var c=d.url,l=d.title,e,h=k(),f;1!==p.nodeType;)p=p.parentNode;e=a(p);f=e.find("a");0<f.length&&f.attr(h,"1");m.execCommand("createLink",
!1,c);c=e.find("a").not("["+h+"]");c.attr("title",l);c.attr("target","_blank");0<f.length&&f.removeAttr(h)},customeInsertImage:function(b,d){for(var c=d.url,f=d.title,e,h=k(),g;1!==p.nodeType;)p=p.parentNode;e=a(p);g=e.find("img");0<g.length&&g.attr(h,"1");m.execCommand("insertImage",!1,c);c=e.find("img").not("["+h+"]");c.attr("title",f);c.attr("alt",f);0<g.length&&g.removeAttr(h)},delete$elem:function(a,d){d.remove()}};q.wangeditor_commonCommand||(q.wangeditor_commonCommand=u);Array.prototype.indexOf||
(Array.prototype.indexOf=function(a){for(var d=0,c=this.length;d<c;d++)if(arr[d]===a)return d;return-1});a.fn.wangEditor=function(b){function d(b){if("|"===b.toString())return a('<div class="split"></div>');var c=b.type,d=b.txt,f=b.title,e=b.command,h=b.dropMenu,k=b.modal,l=b.callback,g=a('<a class="btn btn-default" href="#"></a>');"string"===typeof e&&(e=a.trim(e));-1!==d.indexOf("|")?(b=d.split("|"),d='<i class="'+b[0]+'" style="'+b[1]+'"></i>'):d='<i class="'+d+'"></i>';g.html(d);f&&g.attr("title",
f);if("btn"===c)"string"===typeof e&&g.attr("commandName",e),"string"===typeof e&&g.click(function(a){u(a,e,void 0,l)}),"function"===typeof e&&g.click(function(a){e(a)});else if("dropMenu"===c){var m=function(){h.hide()};g.addClass("btn-drop");g.append(a('<i class="fa fa-angle-down"></i>'));h.attr("class","drop-menu");A.append(h);g.click(function(a){var b=g.offset().top,c=g.offset().left,d=g.height();h.css({top:b+d+5+"px",left:c+"px"});h.show();a.preventDefault();this.focus()}).blur(function(a){setTimeout(m,
100)});h.on("click","a[commandValue]",function(b){var c=a(this).attr("commandValue");u(b,e,c)})}else 0===c.indexOf("modal")&&("modal"===c&&(c=""),k.attr("class","modal "+c),k.prepend(a('<div class="header"><a href="#" class="close"><i class="fa fa-close"></i></a><b>'+f+'</b><div class="clear-both"></div><div class="line"></div></div>')),F.append(k),g.click(function(a){var b=D.width(),c=D.height(),d=k.width(),e=w.offset().top,f=w.height();B.width(b);B.height(c);k.css({top:e+f+"px",left:(b-d)/2+"px"});
B.show();k.show();a.preventDefault()}),k.find(".close").click(function(a){B.hide();k.hide();a.preventDefault()}));if(f){var n=function(){q.show()};g.attr("title","");var p,r,s,q=a('<div class="toolTip"></div>'),c=a('<div class="content">'+f+"</div>"),f=a('<div class="footer"><i class="fa fa-caret-down"></i></div>'),t,v,x,y,z;q.append(c).append(f);C.append(q);g.mouseenter(function(){p=g.offset().top;r=g.offset().left;s=g.width();t=q.height();v=q.width();x=p-t+5;y=r-(v-s)/2+3;q.css({top:x+"px",left:y+
"px"});z=setTimeout(n,200)}).mouseleave(function(){clearTimeout(z);q.hide()})}return g}function c(){var b,c,d,e=f[0];J?(b=m.getSelection(),b.getRangeAt&&b.rangeCount&&(c=m.getSelection().getRangeAt(0),d=c.commonAncestorContainer)):(c=m.selection.createRange(),d=c.parentElement());d&&a.contains(e,d)?(p=d,g=c):g=void 0;H()}function l(){z&&(t.hide(),z=!1)}b=b||{};var e=b.customMenus,h=b.insertBefore,k=b.after,n=b.hideMenuConfig,s,r=this.height(),v=this.html(),A=a("<div></div>"),C=a("<div></div>"),D=
a(q),t=a('<a href="#" class="tableDeleteBtn"><i class="fa fa-close"></i></a>'),z;e&&(a.each(e,function(a){G.push(a)}),y=a.extend(y,e));b.menuConfig?s=b.menuConfig:(s=G,h&&a.each(h,function(b,c){var d=s.indexOf(a.trim(b));-1!==d&&("string"===typeof c&&(c=[c]),c.unshift(0),c.unshift(d),Array.prototype.splice.apply(s,c))}),k&&a.each(k,function(c,b){var d=s.indexOf(a.trim(c));"string"===typeof b&&(b=[b]);d+1===s.length?Array.prototype.push.apply(s,b):(b.unshift(0),b.unshift(d+1),Array.prototype.splice.apply(s,
b))}),n&&a.each(n,function(){var b=a.trim(this),b=s.indexOf(b);-1!==b&&(s[b]=null)}));a.each(s,function(){if(null!=this){var b=a.trim(this);if(b="|"===b?"|":y[b])b=d(b),w.append(b)}});w.append(a('<div class="clear-both"></div>')).append(a('<div class="line"></div>'));f.on("mousedown",function(){f.on("mouseleave",function(){f.off("mouseleave");setTimeout(c,100)})}).on("focus click keyup",function(a){var b=!1;if(b="click"===a.type||"focus"===a.type||"keyup"===a.type&&-1!==" 33, 34, 35, 36, 37, 38, 39, 40, 8, 46 ".indexOf(a.keyCode))c(),
"click"===a.type&&f.off("mouseleave")}).on("focus blur",function(){E()});z=!1;f.on("click","table,img",function(){var b=a(this),c=f.offset().top,d=b.offset().top,e=b.offset().left,g=t.width(),h=t.height();d<=c||(t.css({top:d-h/2+"px",left:e-g/2+"px"}),t.show(),z=!0,f.off("scroll"),f.on("scroll",l),t.off(),t.click(function(a){u(a,"delete$elem",b,l)}))});f.on("keyup blur",function(){setTimeout(l,100)});this.attr("class","wangEditor");this.html("").append(t).append(C).append(B).append(A).append(F).append(w).append(f);
f.html(v);r=r-w.height()-10;f.height(50<=r?r:100);E();return f}}})(window);