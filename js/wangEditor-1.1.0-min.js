(function(u,Q){var F,v,G;function g(){return N+O++}function H(){x||(x=y.find("a[commandName]"));x.each(function(){var c=a(this),q=a.trim(c.attr("commandName")).toLowerCase();"insertunorderedlist"!==q&&"insertorderedlist"!==q&&(l.queryCommandState(q)?c.addClass("btn-selected"):c.removeClass("btn-selected"))})}function P(){var c=b.html();h=[];h.push(c);k=0}function K(){var c=h.length,a=b.html();0<c&&a===h[k]||(h.push(a),20<=c&&h.shift(),c=h.length,k=c-1)}function I(a){return a.parent().is('div[contenteditable="true"]')?
a:"body"===a[0].nodeName.toLowerCase()?b.children().last():a.is('div[contenteditable="true"]')?a.children().last():I(a.parent())}function w(a,q,d,m){if(s){var f;if(s){var e;L?(e=l.getSelection(),e.removeAllRanges(),e.addRange(s)):(e=l.selection.createRange(),e.setEndPoint("EndToEnd",s),0===s.text.length?e.collapse(!1):e.setEndPoint("StartToStart",s),e.select())}try{f=l.queryCommandEnabled(q)}catch(R){f=!1}!0===f?l.execCommand(q,!1,d):(f=M[q])&&f(q,d);m&&m.call(b);H();J.find(".modal").hide();D.hide();
K()}a.preventDefault()}if(u.jQuery){var l=u.document,a=u.jQuery,L="function"===typeof l.createRange,s,n,z,E,b=a('<div contenteditable="true" class="textarea" ></div>'),y=a('<div class="btn-container"></div>'),D=a('<div class="mask"></div>'),J=a("<div></div>"),x,M,h=[],k=-1,N="wangeditor_"+Math.random().toString().replace(".","")+"_",O=1;u.wangEditor_getUniqeId||(u.wangEditor_getUniqeId=g);F="\u5b8b\u4f53;\u9ed1\u4f53;\u6977\u4f53;\u96b6\u4e66;\u5e7c\u5706;\u5fae\u8f6f\u96c5\u9ed1;Arial;Verdana;Georgia;Times New Roman;Trebuchet MS;Courier New;Impact;Comic Sans MS".split(";");
v={"#880000":"\u6697\u7ea2\u8272","#800080":"\u7d2b\u8272","#ff0000":"\u7ea2\u8272","#ff00ff":"\u9c9c\u7c89\u8272","#000080":"\u6df1\u84dd\u8272","#0000ff":"\u84dd\u8272","#00ffff":"\u6e56\u84dd\u8272","#008080":"\u84dd\u7eff\u8272","#008000":"\u7eff\u8272","#808000":"\u6a44\u6984\u8272","#00ff00":"\u6d45\u7eff\u8272","#ffcc00":"\u6a59\u9ec4\u8272","#808080":"\u7070\u8272","#c0c0c0":"\u94f6\u8272","#000000":"\u9ed1\u8272"};G={1:"10px",2:"13px",3:"16px",4:"19px",5:"22px",6:"25px",7:"28px"};E="fontFamily fontSize | bold underline italic | foreColor backgroundColor removeFormat | unOrderedList orderedList | justifyLeft justifyCenter justifyRight | createLink unLink | insertHr insertTable webImage | undo redo".split(" ");
z={fontFamily:{title:"\u5b57\u4f53",type:"dropMenu",txt:"fa fa-font",command:"fontName ",dropMenu:function(){var c=[];a.each(F,function(a,d){c.push('<li><a href="#" commandValue="${value}" style="font-family:${family};">${txt}</a></li>'.replace("${value}",d).replace("${family}",d).replace("${txt}",d))});return a("<ul>"+c.join("")+"</ul>")}()},fontSize:{title:"\u5b57\u53f7",type:"dropMenu",txt:"fa fa-text-height",command:"fontSize",dropMenu:function(){var c=[];a.each(G,function(a,d){c.push('<li><a href="#" commandValue="${value}" style="font-size:${fontsize};">${txt}</a></li>'.replace("${value}",
a).replace("${fontsize}",d).replace("${txt}",d))});return a("<ul>"+c.join("")+"</ul>")}()},bold:{title:"\u52a0\u7c97",type:"btn",hotKey:"ctrl + b",txt:"fa fa-bold",command:"bold",callback:function(){}},underline:{title:"\u4e0b\u5212\u7ebf",type:"btn",hotKey:"ctrl + u",txt:"fa fa-underline",command:"underline "},italic:{title:"\u659c\u4f53",type:"btn",hotKey:"ctrl + i",txt:"fa fa-italic",command:"italic "},foreColor:{title:"\u524d\u666f\u8272",type:"dropMenu",txt:"fa fa-pencil|color:#4a7db1",command:"foreColor ",
dropMenu:function(){var c=[];a.each(v,function(a,d){c.push('<li><a href="#" commandValue="${value}" style="color:${color};">${txt}</a></li>'.replace("${value}",a).replace("${color}",a).replace("${txt}",d))});return a("<ul>"+c.join("")+"</ul>")}()},backgroundColor:{title:"\u80cc\u666f\u8272",type:"dropMenu",txt:"fa fa-paint-brush|color:Red",command:"backColor ",dropMenu:function(){var c=[];a.each(v,function(a,d){c.push('<li><a href="#" commandValue="${value}" style="background-color:${color};color:#ffffff;">${txt}</a></li>'.replace("${value}",
a).replace("${color}",a).replace("${txt}",d))});return a("<ul>"+c.join("")+"</ul>")}()},removeFormat:{title:"\u6e05\u9664\u683c\u5f0f",type:"btn",txt:"fa fa-eraser",command:"RemoveFormat "},unOrderedList:{title:"\u65e0\u5e8f\u5217\u8868",type:"btn",txt:"fa fa-list-ul",command:"InsertUnorderedList "},orderedList:{title:"\u6709\u5e8f\u5217\u8868",type:"btn",txt:"fa fa-list-ol",command:"InsertOrderedList "},justifyLeft:{title:"\u5de6\u5bf9\u9f50",type:"btn",txt:"fa fa-align-left",command:"JustifyLeft "},
justifyCenter:{title:"\u5c45\u4e2d",type:"btn",txt:"fa fa-align-center",command:"JustifyCenter"},justifyRight:{title:"\u53f3\u5bf9\u9f50",type:"btn",txt:"fa fa-align-right",command:"JustifyRight "},createLink:{title:"\u63d2\u5165\u94fe\u63a5",type:"modal-small",txt:"fa fa-link",modal:function(){var c=g(),q=g(),d=g(),b=g();$modal=a('<div>   \u94fe\u63a5\uff1a<input id="'+c+'" type="text" style="width:300px;"/><br />   \u6807\u9898\uff1a<input id="'+q+'" type="text" style="width:300px;"/><br />   \u65b0\u7a97\u53e3\uff1a<input id="'+
d+'" type="checkbox" checked="checked"/><br />   <button id="'+b+'" type="button" class="btn">\u63d2\u5165\u94fe\u63a5</button></div>');callback=function(){$modal.find("input").val("")};$modal.find("#"+b).click(function(f){var e=a.trim($modal.find("#"+c).val()),b=a.trim($modal.find("#"+q).val()),m=$modal.find("#"+d).is(":checked");e||(e=a.trim(l.getElementById(c).value),b=a.trim(l.getElementById(q).value));""!==e&&(""!==b||m?w(f,"customCreateLink",{url:e,title:b,isBlank:m},callback):w(f,"createLink",
e,callback))});return $modal}()},unLink:{title:"\u53d6\u6d88\u94fe\u63a5",type:"btn",txt:"fa fa-unlink",command:"unLink "},insertHr:{title:"\u63d2\u5165\u6a2a\u7ebf",type:"btn",txt:"fa fa-minus",command:"InsertHorizontalRule "},insertTable:{title:"\u63d2\u5165\u8868\u683c",type:"modal-small",txt:"fa fa-table",modal:function(){var c=g(),q=g(),d=g(),b=g(),f=a('<div>   \u884c\u6570\uff1a<input id="'+c+'" type="text" style="width:30px;"/>   \u5217\u6570\uff1a<input id="'+q+'" type="text"  style="width:30px;"/>   \u663e\u793a\u6807\u9898\u884c\uff1a<input id="'+
d+'" type="checkbox" checked="checked"/>   &nbsp;&nbsp;&nbsp;&nbsp;   <button id="'+b+'" class="btn">\u63d2\u5165\u8868\u683c</button>',"</div>"),e=function(){f.find("input").val("")};f.find("#"+b).click(function(a){var b=f.find("#"+c).val(),b=""===b||isNaN(+b)?3:b,m=f.find("#"+q).val(),m=""===m||isNaN(+m)?5:m,l=f.find("#"+d).is(":checked"),g,k;g="";var h=[],n=[];for(g=0;g<b;g++){n=[];for(k=0;k<m;k++)n.push('<td style="width:100px;">&nbsp;</td>');0===g&&l?h.push('<tr style="font-weight:bold;background-color:#f1f1f1;">${content}</tr>'.replace("${content}",
n.join(""))):h.push("<tr>${content}</tr>".replace("${content}",n.join("")))}g='<table border="1" bordercolor="#cccccc" cellpadding="0" cellspacing="0" style="border-collapse:collapse;" > ${content} </table>'.replace("${content}",h.join(""));w(a,"insertHTML",g,e)});return f}()},webImage:{title:"\u7f51\u7edc\u56fe\u7247",type:"modal-small",txt:"fa fa-image",modal:function(){var c=g(),b=g(),d=g();$modal=a('<div>   \u7f51\u5740\uff1a<input id="'+c+'" type="text" style="width:300px;"/><br/>   \u6807\u9898\uff1a<input id="'+
b+'" type="text" style="width:300px;"/><br/>   <button id="'+d+'" type="button" class="btn">\u63d2\u5165\u56fe\u7247</button></div>');callback=function(){$modal.find("input").val("")};$modal.find("#"+d).click(function(d){var f=a.trim($modal.find("#"+c).val()),e=a.trim($modal.find("#"+b).val());f||(f=a.trim(l.getElementById(c).value),e=a.trim(l.getElementById(e).value));""!==f&&(""===e?w(d,"insertImage",f,callback):w(d,"customeInsertImage",{url:f,title:e},callback))});return $modal}()},undo:{title:"\u64a4\u9500",
type:"btn",hotKey:"ctrl+z",txt:"fa fa-undo",command:function(a){0<k&&(k-=1,b.html(h[k]));a.preventDefault()}},redo:{title:"\u91cd\u590d",type:"btn",txt:"fa fa-repeat",command:function(a){k<h.length-1&&(k+=1,b.html(h[k]));a.preventDefault()}}};M={insertHTML:function(c,b){var d;s&&(d=I(a(n)),0===d.next().length&&(b+="<p>&nbsp;</p>"),d.after(a(b)))},customCreateLink:function(c,b){for(var d=b.url,m=b.title,f,e=g(),k;1!==n.nodeType;)n=n.parentNode;f=a(n);k=f.find("a");0<k.length&&k.attr(e,"1");l.execCommand("createLink",
!1,d);d=f.find("a").not("["+e+"]");d.attr("title",m);d.attr("target","_blank");0<k.length&&k.removeAttr(e)},customeInsertImage:function(c,b){for(var d=b.url,k=b.title,f,e=g(),h;1!==n.nodeType;)n=n.parentNode;f=a(n);h=f.find("img");0<h.length&&h.attr(e,"1");l.execCommand("insertImage",!1,d);d=f.find("img").not("["+e+"]");d.attr("title",k);d.attr("alt",k);0<h.length&&h.removeAttr(e)},delete$elem:function(a,b){b.remove()}};u.wangeditor_commonCommand||(u.wangeditor_commonCommand=w);Array.prototype.indexOf||
(Array.prototype.indexOf=function(a){for(var b=0,d=this.length;b<d;b++)if(this[b]===a)return b;return-1});a.fn.wangEditor=function(c){function k(c){if("|"===c.toString())return a('<div class="split"></div>');var d=c.type,f=c.txt,e=c.title,g=c.command,h=c.hotKey,l=[],q,n=c.dropMenu,m=c.modal,r=c.callback,p=a('<a class="btn btn-default" href="#"></a>');"string"===typeof g&&(g=a.trim(g));-1!==f.indexOf("|")?(c=f.split("|"),f='<i class="'+c[0]+'" style="'+c[1]+'"></i>'):f='<i class="'+f+'"></i>';p.html(f);
e&&p.attr("title",e);if("btn"===d)"string"===typeof g&&p.attr("commandName",g),"string"===typeof g&&p.click(function(a){w(a,g,void 0,r)}),"function"===typeof g&&p.click(function(a){g(a)}),h&&(h=h.toLowerCase(),q=a.trim(h.split("+")[1]),l=h.split("+")[0].split(","),a.each(l,function(c,b){l[c]=a.trim(b)}),b.on("keydown",function(a){!1!==(-1!==l.indexOf("ctrl")&&!a.ctrlKey||-1!==l.indexOf("shift")&&!a.shiftKey||-1!==l.indexOf("alt")&&!a.altKey||-1!==l.indexOf("meta")&&!a.metaKey?!1:!0)&&String.fromCharCode(a.keyCode).toLowerCase()===
q&&(a.preventDefault(),p.click())}));else if("dropMenu"===d){var s=function(){n.hide()};p.addClass("btn-drop");p.append(a('<i class="fa fa-angle-down"></i>'));n.attr("class","drop-menu");F.append(n);p.click(function(a){var c=p.offset().top,b=p.offset().left,d=p.height();n.css({top:c+d+5+"px",left:b+"px"});n.show();a.preventDefault();this.focus()}).blur(function(a){setTimeout(s,100)});n.on("click","a[commandValue]",function(c){var b=a(this).attr("commandValue");w(c,g,b)})}else 0===d.indexOf("modal")&&
("modal"===d&&(d=""),m.attr("class","modal "+d),m.prepend(a('<div class="header"><a href="#" class="close"><i class="fa fa-close"></i></a><b>'+e+'</b><div class="clear-both"></div><div class="line"></div></div>')),J.append(m),p.click(function(a){var c=I.width(),b=I.height(),d=m.width(),e=y.offset().top,f=y.height();D.width(c);D.height(b);m.css({top:e+f+"px",left:(c-d)/2+"px"});D.show();m.show();a.preventDefault()}),m.find(".close").click(function(a){D.hide();m.hide();a.preventDefault()}));if(e){var u=
function(){B.show()};p.attr("title","");h&&(e=e+"("+h+")");var t,v,x,B=a('<div class="toolTip"></div>'),d=a('<div class="content">'+e+"</div>"),e=a('<div class="footer"><i class="fa fa-caret-down"></i></div>'),z,A,C,E,H;B.append(d).append(e);G.append(B);p.mouseenter(function(){t=p.offset().top;v=p.offset().left;x=p.width();z=B.height();A=B.width();C=t-z+5;E=v-(A-x)/2+3;B.css({top:C+"px",left:E+"px"});H=setTimeout(u,200)}).mouseleave(function(){clearTimeout(H);B.hide()})}return p}function d(){var c,
d,e,f=b[0];L?(c=l.getSelection(),c.getRangeAt&&c.rangeCount&&(d=l.getSelection().getRangeAt(0),e=d.commonAncestorContainer)):(d=l.selection.createRange(),e=d.parentElement());e&&(a.contains(f,e)||f===e)?(n=e,s=d):s=void 0;H()}function g(){C&&(t.hide(),C=!1)}c=c||{};var f=c.customMenus,e=c.insertBefore,h=c.after,v=c.hideMenuConfig,r,A=this.height(),x=this.html(),F=a("<div></div>"),G=a("<div></div>"),I=a(u),t=a('<a href="#" class="tableDeleteBtn"><i class="fa fa-close"></i></a>'),C;f&&(a.each(f,function(a){E.push(a)}),
z=a.extend(z,f));c.menuConfig?r=c.menuConfig:(r=E,e&&a.each(e,function(c,b){var d=r.indexOf(a.trim(c));-1!==d&&("string"===typeof b&&(b=[b]),b.unshift(0),b.unshift(d),Array.prototype.splice.apply(r,b))}),h&&a.each(h,function(c,b){var d=r.indexOf(a.trim(c));"string"===typeof b&&(b=[b]);d+1===r.length?Array.prototype.push.apply(r,b):(b.unshift(0),b.unshift(d+1),Array.prototype.splice.apply(r,b))}),v&&a.each(v,function(){var b=a.trim(this),b=r.indexOf(b);-1!==b&&(r[b]=null)}));a.each(r,function(){if(null!=
this){var b=a.trim(this);if(b="|"===b?"|":z[b])b=k(b),y.append(b)}});y.append(a('<div class="clear-both"></div>')).append(a('<div class="line"></div>'));b.on("mousedown",function(){b.on("mouseleave",function(){b.off("mouseleave");setTimeout(d,100)})}).on("focus click keyup",function(a){var c=!1;if(c="click"===a.type||"focus"===a.type||"keyup"===a.type&&-1!==" 33, 34, 35, 36, 37, 38, 39, 40, 8, 46 ".indexOf(a.keyCode))d(),"click"===a.type&&b.off("mouseleave")}).on("focus blur",function(){K()});C=!1;
b.on("click","table,img",function(){var c=a(this),d=b.offset().top,e=c.offset().top,f=c.offset().left,h=t.width(),k=t.height();e<=d||(t.css({top:e-k/2+"px",left:f-h/2+"px"}),t.show(),C=!0,b.off("scroll"),b.on("scroll",g),t.off(),t.click(function(a){w(a,"delete$elem",c,g)}))});b.on("keyup blur",function(){setTimeout(g,100)});this.attr("class","wangEditor");this.html("").append(t).append(G).append(D).append(F).append(J).append(y).append(b);b.html(x);A=A-y.height()-10;b.height(50<=A?A:100);P();return b}}})(window);