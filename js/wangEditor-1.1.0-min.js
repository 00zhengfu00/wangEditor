(function(u,R){var E,A,J;function k(){return P+"_"+Q++}function B(){var c=l.length,a=g.html();0<c&&a===l[c-1]||(l.push(a),20<=c&&l.shift(),c=l.length,q=c-1)}function K(a){return a.parent().is('div[contenteditable="true"]')?a:"body"===a[0].nodeName.toLowerCase()?g.children().last():a.is('div[contenteditable="true"]')?a.children().last():K(a.parent())}function t(a,d,b,e){if(r){var f;if(r){var h;L?(h=m.getSelection(),h.removeAllRanges(),h.addRange(r)):(h=m.selection.createRange(),h.setEndPoint("EndToEnd",
r),0===r.text.length?h.collapse(!1):h.setEndPoint("StartToStart",r),h.select())}try{f=m.queryCommandEnabled(d)}catch(p){f=!1}!0===f?m.execCommand(d,!1,b):(f=M[d])&&f(d,b);e&&e.call(g);N();G.find(".modal").hide();C.hide();B()}a.preventDefault()}function N(){D||(D=v.find("a[commandName]"));D.each(function(){var c=a(this),d=a.trim(c.attr("commandName")).toLowerCase();"insertunorderedlist"!==d&&"insertorderedlist"!==d&&(m.queryCommandState(d)?c.addClass("btn-selected"):c.removeClass("btn-selected"))})}
if(u.jQuery){var m=u.document,a=u.jQuery,L="function"===typeof m.createRange,w,r,s,g=a('<div contenteditable="true" class="textarea" ></div>'),v=a('<div class="btn-container"></div>'),C=a('<div class="mask"></div>'),G=a("<div></div>"),D,M,l=[],q=0,P="wangeditor_"+Math.random().toString().replace(".","")+"_",Q=1;E="\u5b8b\u4f53;\u9ed1\u4f53;\u6977\u4f53;\u96b6\u4e66;\u5e7c\u5706;\u5fae\u8f6f\u96c5\u9ed1;Arial;Verdana;Georgia;Times New Roman;Trebuchet MS;Courier New;Impact;Comic Sans MS".split(";");
A={"#880000":"\u6697\u7ea2\u8272","#800080":"\u7d2b\u8272","#ff0000":"\u7ea2\u8272","#ff00ff":"\u9c9c\u7c89\u8272","#000080":"\u6df1\u84dd\u8272","#0000ff":"\u84dd\u8272","#00ffff":"\u6e56\u84dd\u8272","#008080":"\u84dd\u7eff\u8272","#008000":"\u7eff\u8272","#808000":"\u6a44\u6984\u8272","#00ff00":"\u6d45\u7eff\u8272","#ffcc00":"\u6a59\u9ec4\u8272","#808080":"\u7070\u8272","#c0c0c0":"\u94f6\u8272","#000000":"\u9ed1\u8272"};J={1:"10px",2:"13px",3:"16px",4:"19px",5:"22px",6:"25px",7:"28px"};M={insertHTML:function(c,
d){var b;r&&(b=K(a(s)),0===b.next().length&&(d+="<p>&nbsp;</p>"),b.after(a(d)))},customCreateLink:function(c,d){for(var b=d.url,e=d.title,f,h=k(),p;1!==s.nodeType;)s=s.parentNode;f=a(s);p=f.find("a");0<p.length&&p.attr(h,"1");m.execCommand("createLink",!1,b);b=f.find("a").not("["+h+"]");b.attr("title",e);b.attr("target","_blank");0<p.length&&p.removeAttr(h)},customeInsertImage:function(c,d){for(var b=d.url,e=d.title,f,h=k(),p;1!==s.nodeType;)s=s.parentNode;f=a(s);p=f.find("img");0<p.length&&p.attr(h,
"1");m.execCommand("insertImage",!1,b);b=f.find("img").not("["+h+"]");b.attr("title",e);b.attr("alt",e);0<p.length&&p.removeAttr(h)},delete$table:function(a,d){d.remove()}};w=[{title:"\u5b57\u4f53",type:"dropMenu",txt:"fa fa-font",command:"fontName ",dropMenu:function(){var c=[];a.each(E,function(a,b){c.push('<li><a href="#" commandValue="${value}" style="font-family:${family};">${txt}</a></li>'.replace("${value}",b).replace("${family}",b).replace("${txt}",b))});return a("<ul>"+c.join("")+"</ul>")}()},
{title:"\u5b57\u53f7",type:"dropMenu",txt:"fa fa-text-height",command:"fontSize",dropMenu:function(){var c=[];a.each(J,function(a,b){c.push('<li><a href="#" commandValue="${value}" style="font-size:${fontsize};">${txt}</a></li>'.replace("${value}",a).replace("${fontsize}",b).replace("${txt}",b))});return a("<ul>"+c.join("")+"</ul>")}()},"split",{title:"\u52a0\u7c97",type:"btn",txt:"fa fa-bold",command:"bold",callback:function(){}},{title:"\u4e0b\u5212\u7ebf",type:"btn",txt:"fa fa-underline",command:"underline "},
{title:"\u659c\u4f53",type:"btn",txt:"fa fa-italic",command:"italic "},"split",{title:"\u524d\u666f\u8272",type:"dropMenu",txt:"fa fa-pencil|color:#4a7db1",command:"foreColor ",dropMenu:function(){var c=[];a.each(A,function(a,b){c.push('<li><a href="#" commandValue="${value}" style="color:${color};">${txt}</a></li>'.replace("${value}",a).replace("${color}",a).replace("${txt}",b))});return a("<ul>"+c.join("")+"</ul>")}()},{title:"\u80cc\u666f\u8272",type:"dropMenu",txt:"fa fa-paint-brush|color:Red",
command:"backColor ",dropMenu:function(){var c=[];a.each(A,function(a,b){c.push('<li><a href="#" commandValue="${value}" style="background-color:${color};color:#ffffff;">${txt}</a></li>'.replace("${value}",a).replace("${color}",a).replace("${txt}",b))});return a("<ul>"+c.join("")+"</ul>")}()},{title:"\u6e05\u9664\u683c\u5f0f",type:"btn",txt:"fa fa-eraser",command:"RemoveFormat "},"split",{title:"\u65e0\u5e8f\u5217\u8868",type:"btn",txt:"fa fa-list-ul",command:"InsertUnorderedList "},{title:"\u6709\u5e8f\u5217\u8868",
type:"btn",txt:"fa fa-list-ol",command:"InsertOrderedList "},"split",{title:"\u5de6\u5bf9\u9f50",type:"btn",txt:"fa fa-align-left",command:"JustifyLeft "},{title:"\u5c45\u4e2d",type:"btn",txt:"fa fa-align-center",command:"JustifyCenter"},{title:"\u53f3\u5bf9\u9f50",type:"btn",txt:"fa fa-align-right",command:"JustifyRight "},"split",{title:"\u63d2\u5165\u94fe\u63a5",type:"modal",txt:"fa fa-link",modal:function(){var c=k(),d=k(),b=k(),e=k();$modal=a('<div>   \u94fe\u63a5\uff1a<input id="'+c+'" type="text" style="width:300px;"/><br />   \u6807\u9898\uff1a<input id="'+
d+'" type="text" style="width:300px;"/><br />   \u65b0\u7a97\u53e3\uff1a<input id="'+b+'" type="checkbox" checked="checked"><br />   <button id="'+e+'" type="button" class="btn">\u63d2\u5165\u94fe\u63a5</button></div>');callback=function(){$modal.find("input").val("")};$modal.find("#"+e).click(function(f){var h=a.trim($modal.find("#"+c).val()),e=a.trim($modal.find("#"+d).val()),g=$modal.find("#"+b).is(":checked");h||(h=a.trim(m.getElementById(c).value),e=a.trim(m.getElementById(d).value));""!==h&&
(""!==e||g?t(f,"customCreateLink",{url:h,title:e,isBlank:g},callback):t(f,"createLink",h,callback))});return $modal}()},{title:"\u53d6\u6d88\u94fe\u63a5",type:"btn",txt:"fa fa-unlink",command:"unLink "},"split",{title:"\u63d2\u5165\u6a2a\u7ebf",type:"btn",txt:"fa fa-minus",command:"InsertHorizontalRule "},{title:"\u63d2\u5165\u8868\u683c",type:"modal",txt:"fa fa-table",modal:function(){var c=k(),d=k(),b=k(),e=k(),f=a('<div>   \u884c\u6570\uff1a<input id="'+c+'" type="text" style="width:30px;"/>   \u5217\u6570\uff1a<input id="'+
d+'" type="text"  style="width:30px;"/>   \u663e\u793a\u6807\u9898\u884c\uff1a<input id="'+b+'" type="checkbox" checked="checked">   &nbsp;&nbsp;&nbsp;&nbsp;   <button id="'+e+'" class="btn">\u63d2\u5165\u8868\u683c</button>',"</div>"),h=function(){f.find("input").val("")};f.find("#"+e).click(function(a){var e=f.find("#"+c).val(),e=""===e||isNaN(+e)?3:e,g=f.find("#"+d).val(),g=""===g||isNaN(+g)?5:g,m=f.find("#"+b).is(":checked"),y,H;y="";var O,I=[],F=[],k='<td style="width:100px; ${style}">&nbsp;</td>';
O='<table border="0" cellpadding="0" cellspacing="0" style="${style}" > ${content} </table>'.replace("${style}","border-left:1px solid #cccccc;border-top:1px solid #cccccc;");k=k.replace("${style}","border-bottom:1px solid #cccccc;border-right:1px solid #cccccc;");for(y=0;y<e;y++){F=[];for(H=0;H<g;H++)F.push(k);0===y&&m?I.push('<tr style="font-weight:bold;background-color:#f1f1f1;">${content}</tr>'.replace("${content}",F.join(""))):I.push("<tr>${content}</tr>".replace("${content}",F.join("")))}y=
O.replace("${content}",I.join(""));t(a,"insertHTML",y,h)});return f}()},{title:"\u7f51\u7edc\u56fe\u7247",type:"modal",txt:"fa fa-image",modal:function(){var c=k(),d=k(),b=k();$modal=a('<div>   \u7f51\u5740\uff1a<input id="'+c+'" type="text" style="width:300px;"/><br/>   \u6807\u9898\uff1a<input id="'+d+'" type="text" style="width:300px;"/><br/>   <button id="'+b+'" type="button" class="btn">\u63d2\u5165\u56fe\u7247</button></div>');callback=function(){$modal.find("input").val("")};$modal.find("#"+
b).click(function(b){var f=a.trim($modal.find("#"+c).val()),h=a.trim($modal.find("#"+d).val());f||(f=a.trim(m.getElementById(c).value),h=a.trim(m.getElementById(h).value));""!==f&&(""===h?t(b,"insertImage",f,callback):t(b,"customeInsertImage",{url:f,title:h},callback))});return $modal}()},"split",{title:"\u64a4\u9500",type:"btn",txt:"fa fa-undo",command:function(a){0<q&&(q-=1,g.html(l[q]));a.preventDefault()},callback:function(){}},{title:"\u91cd\u590d",type:"btn",txt:"fa fa-repeat",command:function(a){q<
l.length-1&&(q+=1,g.html(l[q]));a.preventDefault()}}];a.fn.wangEditor=function(c){function d(b){if("split"===b.toString())return a('<div class="split"></div>');var c=b.type,d=b.txt,f=b.title,e=b.command,g=b.dropMenu,k=b.modal,l=b.callback,n=a('<a class="btn btn-default" href="#"></a>');"string"===typeof e&&(e=a.trim(e));-1!==d.indexOf("|")?(b=d.split("|"),d='<i class="'+b[0]+'" style="'+b[1]+'"></i>'):d='<i class="'+d+'"></i>';n.html(d);f&&n.attr("title",f);if("btn"===c)"string"===typeof e&&n.attr("commandName",
e),"string"===typeof e&&n.click(function(a){t(a,e,void 0,l)}),"function"===typeof e&&n.click(function(a){e(a)});else if("dropMenu"===c){var m=function(){g.hide()};n.addClass("btn-drop");n.append(a('<i class="fa fa-angle-down"></i>'));g.attr("class","drop-menu");h.append(g);n.click(function(a){var b=n.offset().top,c=n.offset().left,d=n.height();g.css({top:b+d+5+"px",left:c+"px"});g.show();a.preventDefault()}).blur(function(a){setTimeout(m,100)});g.on("click","a[commandValue]",function(b){var c=a(this).attr("commandValue");
t(b,e,c)})}else"modal"===c&&(k.attr("class","modal modal-small"),k.prepend(a('<div class="header"><a href="#" class="close"><i class="fa fa-close"></i></a><b>'+f+'</b><div class="clear-both"></div><div class="line"></div></div>')),G.append(k),n.click(function(a){var b=q.width(),c=q.height(),d=k.width(),e=v.offset().top,f=v.height();C.width(b);C.height(c);k.css({top:e+f+"px",left:(b-d)/2+"px"});C.show();k.show();a.preventDefault()}),k.find(".close").click(function(a){C.hide();k.hide();a.preventDefault()}));
if(f){var s=function(){z.show()};n.attr("title","");var r,u,w,z=a('<div class="toolTip"></div>'),c=a('<div class="content">'+f+"</div>"),f=a('<div class="footer"><i class="fa fa-caret-down"></i></div>'),x,A,B,D,E;z.append(c).append(f);p.append(z);n.mouseenter(function(){r=n.offset().top;u=n.offset().left;w=n.width();x=z.height();A=z.width();B=r-x+5;D=u-(A-w)/2+3;z.css({top:B+"px",left:D+"px"});E=setTimeout(s,200)}).mouseleave(function(){clearTimeout(E);z.hide()})}return n}function b(){x&&(l.hide(),
x=!1)}var e=this.height(),f=this.html(),h=a("<div></div>"),p=a("<div></div>"),q=a(u),l=a('<a href="#" class="tableDeleteBtn"><i class="fa fa-close"></i></a>'),x;c&&(w=a.extend(w,c));a.each(w,function(){var a=d(this);v.append(a)});v.append(a('<div class="clear-both"></div>')).append(a('<div class="line"></div>'));g.on("focus click keyup",function(b){var c=!1;if(c="click"===b.type||"focus"===b.type||"keyup"===b.type&&-1!==" 33, 34, 35, 36, 37, 38, 39, 40, 8, 46 ".indexOf(b.keyCode)){var d,e,c=g[0];
L?(b=m.getSelection(),b.getRangeAt&&b.rangeCount&&(d=m.getSelection().getRangeAt(0),e=d.commonAncestorContainer)):(d=m.selection.createRange(),e=d.parentElement());e&&(e.id=c.id||a.contains(c,e))?(s=e,r=d):r=void 0;N()}});g.on("focus blur",function(){B()});x=!1;g.on("click","table,img",function(){var c=a(this),d=g.offset().top,e=c.offset().top,f=c.offset().left,h=l.width(),k=l.height();e<=d||(l.css({top:e-k/2+"px",left:f-h/2+"px"}),l.show(),x=!0,g.off("scroll"),g.on("scroll",b),l.off(),l.click(function(a){t(a,
"delete$table",c,b)}))});g.on("keyup blur",function(){setTimeout(b,100)});this.attr("class","wangEditor");this.html("").append(l).append(p).append(C).append(h).append(G).append(v).append(g);g.html(f);e=e-v.height()-10;g.height(50<=e?e:100);g.attr("id",k());B();return g}}})(window);