(function(v,P){var C,t,D;function m(){return N+"_"+O++}function I(){A||(A=w.find("a[commandName]"));A.each(function(){var a=b(this),f=b.trim(a.attr("commandName")).toLowerCase();"insertunorderedlist"!==f&&"insertorderedlist"!==f&&(k.queryCommandState(f)?a.addClass("btn-selected"):a.removeClass("btn-selected"))})}function F(){var a=s.length,b=h.html();0<a&&b===s[a-1]||(s.push(b),20<=a&&s.shift(),a=s.length,l=a-1)}function J(a){return a.parent().is('div[contenteditable="true"]')?a:"body"===a[0].nodeName.toLowerCase()?
h.children().last():a.is('div[contenteditable="true"]')?a.children().last():J(a.parent())}function u(a,b,c,n){if(p){var e;if(p){var d;K?(d=k.getSelection(),d.removeAllRanges(),d.addRange(p)):(d=k.selection.createRange(),d.setEndPoint("EndToEnd",p),0===p.text.length?d.collapse(!1):d.setEndPoint("StartToStart",p),d.select())}try{e=k.queryCommandEnabled(b)}catch(x){e=!1}!0===e?k.execCommand(b,!1,c):(e=L[b])&&e(b,c);n&&n.call(h);I();G.find(".modal").hide();B.hide();F()}a.preventDefault()}if(v.jQuery){var k=
v.document,b=v.jQuery,K="function"===typeof k.createRange,p,q,y,M,h=b('<div contenteditable="true" class="textarea" ></div>'),w=b('<div class="btn-container"></div>'),B=b('<div class="mask"></div>'),G=b("<div></div>"),A,L,s=[],l=0,N="wangeditor_"+Math.random().toString().replace(".","")+"_",O=1;C="\u5b8b\u4f53;\u9ed1\u4f53;\u6977\u4f53;\u96b6\u4e66;\u5e7c\u5706;\u5fae\u8f6f\u96c5\u9ed1;Arial;Verdana;Georgia;Times New Roman;Trebuchet MS;Courier New;Impact;Comic Sans MS".split(";");t={"#880000":"\u6697\u7ea2\u8272",
"#800080":"\u7d2b\u8272","#ff0000":"\u7ea2\u8272","#ff00ff":"\u9c9c\u7c89\u8272","#000080":"\u6df1\u84dd\u8272","#0000ff":"\u84dd\u8272","#00ffff":"\u6e56\u84dd\u8272","#008080":"\u84dd\u7eff\u8272","#008000":"\u7eff\u8272","#808000":"\u6a44\u6984\u8272","#00ff00":"\u6d45\u7eff\u8272","#ffcc00":"\u6a59\u9ec4\u8272","#808080":"\u7070\u8272","#c0c0c0":"\u94f6\u8272","#000000":"\u9ed1\u8272"};D={1:"10px",2:"13px",3:"16px",4:"19px",5:"22px",6:"25px",7:"28px"};M="fontFamily fontSize | bold underline italic | foreColor backgroundColor removeFormat | unOrderedList orderedList | justifyLeft justifyCenter justifyRight | createLink unLink | insertHr insertTable webImage | undo redo".split(" ");
y={fontFamily:{title:"\u5b57\u4f53",type:"dropMenu",txt:"fa fa-font",command:"fontName ",dropMenu:function(){var a=[];b.each(C,function(b,c){a.push('<li><a href="#" commandValue="${value}" style="font-family:${family};">${txt}</a></li>'.replace("${value}",c).replace("${family}",c).replace("${txt}",c))});return b("<ul>"+a.join("")+"</ul>")}()},fontSize:{title:"\u5b57\u53f7",type:"dropMenu",txt:"fa fa-text-height",command:"fontSize",dropMenu:function(){var a=[];b.each(D,function(b,c){a.push('<li><a href="#" commandValue="${value}" style="font-size:${fontsize};">${txt}</a></li>'.replace("${value}",
b).replace("${fontsize}",c).replace("${txt}",c))});return b("<ul>"+a.join("")+"</ul>")}()},bold:{title:"\u52a0\u7c97",type:"btn",txt:"fa fa-bold",command:"bold",callback:function(){}},underline:{title:"\u4e0b\u5212\u7ebf",type:"btn",txt:"fa fa-underline",command:"underline "},italic:{title:"\u659c\u4f53",type:"btn",txt:"fa fa-italic",command:"italic "},foreColor:{title:"\u524d\u666f\u8272",type:"dropMenu",txt:"fa fa-pencil|color:#4a7db1",command:"foreColor ",dropMenu:function(){var a=[];b.each(t,
function(b,c){a.push('<li><a href="#" commandValue="${value}" style="color:${color};">${txt}</a></li>'.replace("${value}",b).replace("${color}",b).replace("${txt}",c))});return b("<ul>"+a.join("")+"</ul>")}()},backgroundColor:{title:"\u80cc\u666f\u8272",type:"dropMenu",txt:"fa fa-paint-brush|color:Red",command:"backColor ",dropMenu:function(){var a=[];b.each(t,function(b,c){a.push('<li><a href="#" commandValue="${value}" style="background-color:${color};color:#ffffff;">${txt}</a></li>'.replace("${value}",
b).replace("${color}",b).replace("${txt}",c))});return b("<ul>"+a.join("")+"</ul>")}()},removeFormat:{title:"\u6e05\u9664\u683c\u5f0f",type:"btn",txt:"fa fa-eraser",command:"RemoveFormat "},unOrderedList:{title:"\u65e0\u5e8f\u5217\u8868",type:"btn",txt:"fa fa-list-ul",command:"InsertUnorderedList "},orderedList:{title:"\u6709\u5e8f\u5217\u8868",type:"btn",txt:"fa fa-list-ol",command:"InsertOrderedList "},justifyLeft:{title:"\u5de6\u5bf9\u9f50",type:"btn",txt:"fa fa-align-left",command:"JustifyLeft "},
justifyCenter:{title:"\u5c45\u4e2d",type:"btn",txt:"fa fa-align-center",command:"JustifyCenter"},justifyRight:{title:"\u53f3\u5bf9\u9f50",type:"btn",txt:"fa fa-align-right",command:"JustifyRight "},createLink:{title:"\u63d2\u5165\u94fe\u63a5",type:"modal",txt:"fa fa-link",modal:function(){var a=m(),f=m(),c=m(),n=m();$modal=b('<div>   \u94fe\u63a5\uff1a<input id="'+a+'" type="text" style="width:300px;"/><br />   \u6807\u9898\uff1a<input id="'+f+'" type="text" style="width:300px;"/><br />   \u65b0\u7a97\u53e3\uff1a<input id="'+
c+'" type="checkbox" checked="checked"><br />   <button id="'+n+'" type="button" class="btn">\u63d2\u5165\u94fe\u63a5</button></div>');callback=function(){$modal.find("input").val("")};$modal.find("#"+n).click(function(e){var d=b.trim($modal.find("#"+a).val()),x=b.trim($modal.find("#"+f).val()),g=$modal.find("#"+c).is(":checked");d||(d=b.trim(k.getElementById(a).value),x=b.trim(k.getElementById(f).value));""!==d&&(""!==x||g?u(e,"customCreateLink",{url:d,title:x,isBlank:g},callback):u(e,"createLink",
d,callback))});return $modal}()},unLink:{title:"\u53d6\u6d88\u94fe\u63a5",type:"btn",txt:"fa fa-unlink",command:"unLink "},insertHr:{title:"\u63d2\u5165\u6a2a\u7ebf",type:"btn",txt:"fa fa-minus",command:"InsertHorizontalRule "},insertTable:{title:"\u63d2\u5165\u8868\u683c",type:"modal",txt:"fa fa-table",modal:function(){var a=m(),f=m(),c=m(),n=m(),e=b('<div>   \u884c\u6570\uff1a<input id="'+a+'" type="text" style="width:30px;"/>   \u5217\u6570\uff1a<input id="'+f+'" type="text"  style="width:30px;"/>   \u663e\u793a\u6807\u9898\u884c\uff1a<input id="'+
c+'" type="checkbox" checked="checked">   &nbsp;&nbsp;&nbsp;&nbsp;   <button id="'+n+'" class="btn">\u63d2\u5165\u8868\u683c</button>',"</div>"),d=function(){e.find("input").val("")};e.find("#"+n).click(function(b){var g=e.find("#"+a).val(),g=""===g||isNaN(+g)?3:g,n=e.find("#"+f).val(),n=""===n||isNaN(+n)?5:n,h=e.find("#"+c).is(":checked"),k,m;k="";var q,r=[],l=[],H='<td style="width:100px; ${style}">&nbsp;</td>';q='<table border="0" cellpadding="0" cellspacing="0" style="${style}" > ${content} </table>'.replace("${style}",
"border-left:1px solid #cccccc;border-top:1px solid #cccccc;");H=H.replace("${style}","border-bottom:1px solid #cccccc;border-right:1px solid #cccccc;");for(k=0;k<g;k++){l=[];for(m=0;m<n;m++)l.push(H);0===k&&h?r.push('<tr style="font-weight:bold;background-color:#f1f1f1;">${content}</tr>'.replace("${content}",l.join(""))):r.push("<tr>${content}</tr>".replace("${content}",l.join("")))}k=q.replace("${content}",r.join(""));u(b,"insertHTML",k,d)});return e}()},webImage:{title:"\u7f51\u7edc\u56fe\u7247",
type:"modal",txt:"fa fa-image",modal:function(){var a=m(),f=m(),c=m();$modal=b('<div>   \u7f51\u5740\uff1a<input id="'+a+'" type="text" style="width:300px;"/><br/>   \u6807\u9898\uff1a<input id="'+f+'" type="text" style="width:300px;"/><br/>   <button id="'+c+'" type="button" class="btn">\u63d2\u5165\u56fe\u7247</button></div>');callback=function(){$modal.find("input").val("")};$modal.find("#"+c).click(function(c){var e=b.trim($modal.find("#"+a).val()),d=b.trim($modal.find("#"+f).val());e||(e=b.trim(k.getElementById(a).value),
d=b.trim(k.getElementById(d).value));""!==e&&(""===d?u(c,"insertImage",e,callback):u(c,"customeInsertImage",{url:e,title:d},callback))});return $modal}()},undo:{title:"\u64a4\u9500",type:"btn",txt:"fa fa-undo",command:function(b){0<l&&(l-=1,h.html(s[l]));b.preventDefault()},callback:function(){}},redo:{title:"\u91cd\u590d",type:"btn",txt:"fa fa-repeat",command:function(b){l<s.length-1&&(l+=1,h.html(s[l]));b.preventDefault()}}};L={insertHTML:function(a,f){var c;p&&(c=J(b(q)),0===c.next().length&&(f+=
"<p>&nbsp;</p>"),c.after(b(f)))},customCreateLink:function(a,f){for(var c=f.url,n=f.title,e,d=m(),h;1!==q.nodeType;)q=q.parentNode;e=b(q);h=e.find("a");0<h.length&&h.attr(d,"1");k.execCommand("createLink",!1,c);c=e.find("a").not("["+d+"]");c.attr("title",n);c.attr("target","_blank");0<h.length&&h.removeAttr(d)},customeInsertImage:function(a,f){for(var c=f.url,h=f.title,e,d=m(),l;1!==q.nodeType;)q=q.parentNode;e=b(q);l=e.find("img");0<l.length&&l.attr(d,"1");k.execCommand("insertImage",!1,c);c=e.find("img").not("["+
d+"]");c.attr("title",h);c.attr("alt",h);0<l.length&&l.removeAttr(d)},delete$table:function(b,f){f.remove()}};Array.prototype.indexOf||(Array.prototype.indexOf=function(b){for(var f=0,c=this.length;f<c;f++)if(arr[f]===b)return f;return-1});b.fn.wangEditor=function(a){function f(a){if("|"===a.toString())return b('<div class="split"></div>');var c=a.type,f=a.txt,e=a.title,d=a.command,h=a.dropMenu,k=a.modal,l=a.callback,g=b('<a class="btn btn-default" href="#"></a>');"string"===typeof d&&(d=b.trim(d));
-1!==f.indexOf("|")?(a=f.split("|"),f='<i class="'+a[0]+'" style="'+a[1]+'"></i>'):f='<i class="'+f+'"></i>';g.html(f);e&&g.attr("title",e);if("btn"===c)"string"===typeof d&&g.attr("commandName",d),"string"===typeof d&&g.click(function(b){u(b,d,void 0,l)}),"function"===typeof d&&g.click(function(b){d(b)});else if("dropMenu"===c){var m=function(){h.hide()};g.addClass("btn-drop");g.append(b('<i class="fa fa-angle-down"></i>'));h.attr("class","drop-menu");A.append(h);g.click(function(b){var a=g.offset().top,
c=g.offset().left,d=g.height();h.css({top:a+d+5+"px",left:c+"px"});h.show();b.preventDefault()}).blur(function(b){setTimeout(m,100)});h.on("click","a[commandValue]",function(a){var c=b(this).attr("commandValue");u(a,d,c)})}else"modal"===c&&(k.attr("class","modal modal-small"),k.prepend(b('<div class="header"><a href="#" class="close"><i class="fa fa-close"></i></a><b>'+e+'</b><div class="clear-both"></div><div class="line"></div></div>')),G.append(k),g.click(function(b){var a=D.width(),c=D.height(),
d=k.width(),e=w.offset().top,f=w.height();B.width(a);B.height(c);k.css({top:e+f+"px",left:(a-d)/2+"px"});B.show();k.show();b.preventDefault()}),k.find(".close").click(function(b){B.hide();k.hide();b.preventDefault()}));if(e){var n=function(){p.show()};g.attr("title","");var q,r,s,p=b('<div class="toolTip"></div>'),c=b('<div class="content">'+e+"</div>"),e=b('<div class="footer"><i class="fa fa-caret-down"></i></div>'),t,v,x,y,z;p.append(c).append(e);C.append(p);g.mouseenter(function(){q=g.offset().top;
r=g.offset().left;s=g.width();t=p.height();v=p.width();x=q-t+5;y=r-(v-s)/2+3;p.css({top:x+"px",left:y+"px"});z=setTimeout(n,200)}).mouseleave(function(){clearTimeout(z);p.hide()})}return g}function c(){E&&(r.hide(),E=!1)}a=a||{};var l=a.customMenus,e=a.insertBefore,d=a.after,s=a.hideMenuConfig,g,z=this.height(),t=this.html(),A=b("<div></div>"),C=b("<div></div>"),D=b(v),r=b('<a href="#" class="tableDeleteBtn"><i class="fa fa-close"></i></a>'),E;l&&(y=b.extend(y,l));a.menuConfig?g=a.menuConfig:(g=M,
e&&b.each(e,function(a,c){var d=g.indexOf(b.trim(a));-1!==d&&("string"===typeof c&&(c=[c]),c.unshift(0),c.unshift(d),Array.prototype.splice.apply(g,c))}),d&&b.each(d,function(a,c){var d=g.indexOf(b.trim(a));"string"===typeof c&&(c=[c]);d+1===g.length?Array.prototype.push.apply(g,c):(c.unshift(0),c.unshift(d+1),Array.prototype.splice.apply(g,c))}),s&&b.each(s,function(){var a=b.trim(this),a=g.indexOf(a);-1!==a&&(g[a]=null)}));b.each(g,function(){if(null!=this){var a=b.trim(this);if(a="|"===a?"|":y[a])a=
f(a),w.append(a)}});w.append(b('<div class="clear-both"></div>')).append(b('<div class="line"></div>'));h.on("focus click keyup",function(a){var c=!1;if(c="click"===a.type||"focus"===a.type||"keyup"===a.type&&-1!==" 33, 34, 35, 36, 37, 38, 39, 40, 8, 46 ".indexOf(a.keyCode)){var d,e,c=h[0];K?(a=k.getSelection(),a.getRangeAt&&a.rangeCount&&(d=k.getSelection().getRangeAt(0),e=d.commonAncestorContainer)):(d=k.selection.createRange(),e=d.parentElement());e&&(e.id=c.id||b.contains(c,e))?(q=e,p=d):p=void 0;
I()}});h.on("focus blur",function(){F()});E=!1;h.on("click","table,img",function(){var a=b(this),d=h.offset().top,e=a.offset().top,f=a.offset().left,g=r.width(),k=r.height();e<=d||(r.css({top:e-k/2+"px",left:f-g/2+"px"}),r.show(),E=!0,h.off("scroll"),h.on("scroll",c),r.off(),r.click(function(b){u(b,"delete$table",a,c)}))});h.on("keyup blur",function(){setTimeout(c,100)});this.attr("class","wangEditor");this.html("").append(r).append(C).append(B).append(A).append(G).append(w).append(h);h.html(t);z=
z-w.height()-10;h.height(50<=z?z:100);h.attr("id",m());F();return h}}})(window);